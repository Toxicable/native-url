import e from"querystring";var t=/https?|ftp|gopher|file/;function r(r){"string"==typeof r&&(r=m(r));var a=function(e,t,r){var a=e.auth,o=e.hostname,s=e.protocol||"",h=e.pathname||"",c=e.hash||"",n=e.query||"",p=!1;a=a?encodeURIComponent(a).replace(/%3A/i,":")+"@":"",e.host?p=a+e.host:o&&(p=a+(~o.indexOf(":")?"["+o+"]":o),e.port&&(p+=":"+e.port)),n&&"object"==typeof n&&(n=t.encode(n));var l=e.search||n&&"?"+n||"";return s&&":"!==s.substr(-1)&&(s+=":"),e.slashes||(!s||r.test(s))&&!1!==p?(p="//"+(p||""),h&&"/"!==h[0]&&(h="/"+h)):p||(p=""),c&&"#"!==c[0]&&(c="#"+c),l&&"?"!==l[0]&&(l="?"+l),{protocol:s,host:p,pathname:h=h.replace(/[?#]/g,encodeURIComponent),search:l=l.replace("#","%23"),hash:c}}(r,e,t);return""+a.protocol+a.host+a.pathname+a.search+a.hash}var a="xyz://",o="w.w",s=a+o,h="http://"+o,c=/^https?|ftp|gopher|file/,n=/^(.+?)([#?].*)/,p=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,l=/^([a-z0-9.+-]*:)?\/\/\/*/i,i=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i;function u(e){try{return decodeURI(e)}catch(t){return e}}function m(t,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);var m=(t=u(t.trim())).match(n);t=m?m[1].replace(/\\/g,"/")+m[2]:t.replace(/\\/g,"/"),i.test(t)&&"/"!==t.slice(-1)&&(t+="/");var f=!/(^javascript)/.test(t)&&t.match(p),v=l.test(t),d="";f&&(c.test(f[1])||(d=f[1].toLowerCase(),t=""+f[2]+f[3]),f[2]||(v=!1,c.test(f[1])?(d=f[1],t=""+f[3]):t="//"+f[3]),3!==f[2].length&&1!==f[2].length||(d=f[1],t="/"+f[3]));var g,b=t.match(/(:[0-9]+)/),y="";b&&b[1]&&3===b[1].length&&(t=t.replace(y=b[1],y+"00"));var w={},R="",U="";try{g=new URL(t)}catch(e){R=e,d||s||!/^\/\//.test(t)||/^\/\/.+[@.]/.test(t)||(U="/",t=t.substr(1));try{g=new URL(t,h)}catch(e){return w.protocol=d,w.href=d,w}}w.slashes=v&&!U,w.host=g.host.includes(o)?"":g.host,w.hostname=g.hostname.includes(o)?"":g.hostname.replace(/(\[|\])/g,""),w.protocol=R?d||null:g.protocol,w.search=g.search.replace(/\\/g,"%5C"),w.hash=g.hash.replace(/\\/g,"%5C");var z=t.split("#");!w.search&&z[0].includes("?")&&(w.search="?"),w.hash||""!==z[1]||(w.hash="#"),w.query=a?e.decode(g.search.substr(1)):w.search.substr(1),w.pathname=U+u(g.pathname).replace(/"/g,"%22"),"about:"===w.protocol&&"blank"===w.pathname&&(w.protocol="",w.pathname=""),R&&"/"!==t[0]&&(w.pathname=w.pathname.substr(1)),d&&!c.test(d)&&"/"!==t.slice(-1)&&"/"===w.pathname&&(w.pathname=""),w.path=w.pathname+w.search,w.auth=[g.username,g.password].map(decodeURIComponent).filter(Boolean).join(":"),w.port=g.port,y&&(w.host=w.host.replace(y+"00",y),w.port=w.port.slice(0,-2)),w.href=U?""+w.pathname+w.search+w.hash:r(w);var C=/^(file)/.test(w.href)?["host","hostname"]:[];return Object.keys(w).forEach(function(e){C.includes(e)||(w[e]=w[e]||null)}),w}var f=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,v=/https?|ftp|gopher|file/;function d(e,t){var h="string"==typeof e?m(e):e;e="object"==typeof e?r(e):e;var c=m(t),n="";h.protocol&&!h.slashes&&(n=h.protocol,e=e.replace(h.protocol,""),n+="/"===t[0]||"/"===e[0]?"/":""),n&&c.protocol&&(n="",c.slashes||(n=c.protocol,t=t.replace(c.protocol,"")));var p=e.match(f);p&&!c.protocol&&(e=e.substr((n=p[1]+(p[2]||"")).length),/^\/\/[^/]/.test(t)&&(n=n.slice(0,-1)));var l=new URL(e,s+"/"),i=new URL(t,l).toString().replace(a,"").replace(o,"");return v.test(i)||t.includes(".")||"/"===e.slice(-1)||"/"===t.slice(-1)||"/"!==i.slice(-1)||(i=i.slice(0,-1)),n&&(i=n+("/"===i[0]?i.substr(1):i)),i}function g(e,t){return m(d(e,t))}export{m as parse,r as format,d as resolve,g as resolveObject};
//# sourceMappingURL=index.mjs.map
